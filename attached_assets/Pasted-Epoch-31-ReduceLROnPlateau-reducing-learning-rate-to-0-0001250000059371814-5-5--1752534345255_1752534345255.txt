Epoch 31: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step - auc: 1.0000 - loss: 0.0099 - val_auc: 0.7909 - val_loss: 0.7232 - learning_rate: 2.5000e-04
Epoch 31: early stopping
Restoring model weights from the end of the best epoch: 23.
2025-07-14 23:04:56,708 | INFO | Fold 3 AUC: 0.7905
2025-07-14 23:04:56,849 | INFO | CV Results - Mean AUC: 0.7873 ± 0.0111
2025-07-14 23:04:56,850 | INFO | Training completed successfully: {'fold_aucs': [0.7794755593983393, 0.791863567925344, 0.7905368137028369], 'mean_auc': 0.7872919803421734, 'std_auc': 0.005553521193509625, 'best_fold': 2}
2025-07-14 23:04:57,047 | ERROR | Model loading failed, attempting to rebuild: `inputs` not connected to `outputs`
2025-07-14 23:04:57,047 | INFO | Rebuilding model with current architecture...
2025-07-14 23:04:57,400 | WARNING | Could not transfer weights: `inputs` not connected to `outputs`, using random initialization
2025-07-14 23:04:57,421 | ERROR | Retraining failed: Prediction failed: Data is expected to be in format `x`, `(x,)`, `(x, y)`, or `(x, y, sample_weight)`, found: (<tf.Tensor 'data:0' shape=(1,) dtype=string>, <tf.Tensor 'data_1:0' shape=(1,) dtype=string>, <tf.Tensor 'data_2:0' shape=(1,) dtype=string>, <tf.Tensor 'data_3:0' shape=(1,) dtype=string>, <tf.Tensor 'data_4:0' shape=(1,) dtype=string>, <tf.Tensor 'data_5:0' shape=(1,) dtype=string>, <tf.Tensor 'data_6:0' shape=(1,) dtype=string>, <tf.Tensor 'data_7:0' shape=(1,) dtype=string>, <tf.Tensor 'data_8:0' shape=(1,) dtype=string>, <tf.Tensor 'data_9:0' shape=(1, 1) dtype=float32>)
Traceback (most recent call last):
  File "/home/runner/workspace/lp_model_training.py", line 533, in predict_one
    prob = float(self.model.predict(ds, verbose=0)[0, 0])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/keras/src/trainers/data_adapters/data_adapter_utils.py", line 51, in unpack_x_y_sample_weight
    raise ValueError(error_msg)
ValueError: Data is expected to be in format `x`, `(x,)`, `(x, y)`, or `(x, y, sample_weight)`, found: (<tf.Tensor 'data:0' shape=(1,) dtype=string>, <tf.Tensor 'data_1:0' shape=(1,) dtype=string>, <tf.Tensor 'data_2:0' shape=(1,) dtype=string>, <tf.Tensor 'data_3:0' shape=(1,) dtype=string>, <tf.Tensor 'data_4:0' shape=(1,) dtype=string>, <tf.Tensor 'data_5:0' shape=(1,) dtype=string>, <tf.Tensor 'data_6:0' shape=(1,) dtype=string>, <tf.Tensor 'data_7:0' shape=(1,) dtype=string>, <tf.Tensor 'data_8:0' shape=(1,) dtype=string>, <tf.Tensor 'data_9:0' shape=(1, 1) dtype=float32>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/runner/workspace/retrain_model.py", line 62, in <module>
    main()
  File "/home/runner/workspace/retrain_model.py", line 54, in main
    result = predictor.predict_one(example)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/lp_model_training.py", line 539, in predict_one
    raise ModelError(f"Prediction failed: {str(e)}")
lp_model_training.ModelError: Prediction failed: Data is expected to be in format `x`, `(x,)`, `(x, y)`, or `(x, y, sample_weight)`, found: (<tf.Tensor 'data:0' shape=(1,) dtype=string>, <tf.Tensor 'data_1:0' shape=(1,) dtype=string>, <tf.Tensor 'data_2:0' shape=(1,) dtype=string>, <tf.Tensor 'data_3:0' shape=(1,) dtype=string>, <tf.Tensor 'data_4:0' shape=(1,) dtype=string>, <tf.Tensor 'data_5:0' shape=(1,) dtype=string>, <tf.Tensor 'data_6:0' shape=(1,) dtype=string>, <tf.Tensor 'data_7:0' shape=(1,) dtype=string>, <tf.Tensor 'data_8:0' shape=(1,) dtype=string>, <tf.Tensor 'data_9:0' shape=(1, 1) dtype=float32>)