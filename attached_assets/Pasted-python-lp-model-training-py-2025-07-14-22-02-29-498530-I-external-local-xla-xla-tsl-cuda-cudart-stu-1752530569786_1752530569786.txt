python lp_model_training.py
2025-07-14 22:02:29.498530: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-07-14 22:02:29.501795: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-07-14 22:02:29.509728: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1752530549.522643   13080 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1752530549.526661   13080 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1752530549.538227   13080 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1752530549.538241   13080 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1752530549.538243   13080 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1752530549.538248   13080 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-07-14 22:02:29.541536: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-07-14 22:02:31,790 | INFO | Initializing data module...
2025-07-14 22:02:31.807923: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: UNKNOWN ERROR (303)
2025-07-14 22:02:31,836 | INFO | Starting training...
2025-07-14 22:02:31,959 | ERROR | Application error: Can't convert Python sequence with mixed types to Tensor.
Traceback (most recent call last):
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/data/util/structure.py", line 105, in normalize_element
    spec = type_spec_from_value(t, use_fallback=False)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/data/util/structure.py", line 514, in type_spec_from_value
    raise TypeError("Could not build a `TypeSpec` for {} with type {}".format(
TypeError: Could not build a `TypeSpec` for [array(['Andrew Ortiz', 'Matthew Johnson', 'Matthew Johnson', ...,
       'Andrew Ortiz', 'Osvaldo Olvera', 'Joseph'], dtype=object), array(['https://www.linkedin.com/in/marco-fiorespino-16bb2a35?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app https://www.linkedin.com/in/marco-fiorespino-16bb2a35?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medi',
       'https://www.linkedin.com/in/aishwarya-a498488/',
       'https://www.linkedin.com/company/16260905/admin/feed/posts/', ...,
       'linkedin.com/in/tretsky - https://linkedin.com/in/tretsky',
       'https://www.linkedin.com/company/menlo-dental-transitions',
       'https://www.linkedin.com/in/aziz-abid-125a55249/'], dtype=object), array(['mfiorespino@wizzmech.com', 'aishwarya.gupta@newpage.io',
       'rick.cole@smithcp.com', ..., 'scott.tretsky@gloveboxapp.com',
       'maggie@menlocre.com', 'aziz@sbtechnology.net'], dtype=object), array(['Wizzmech.com', 'Newpage.io', 'smithcp.com', ..., 'glovebox.io',
       'menlotransitions.com', 'https://sbtechnology.net'], dtype=object), array(['Cold email ', 'LinkedIn Lead Generation',
       'LinkedIn Lead Generation\nLinkedIn Paid Advertising', ...,
       'LinkedIn Lead Generation\nCold Email Lead Generation',
       'Cold Email Lead Generation',
       'LinkedIn Lead Generation\nCold Email Lead Generation'],
      dtype=object), array(['Email', 'Gold', 'Profile Optimization', ..., 'Gold', 'Gold',
       'Email'], dtype=object), array(['Email marketing', 'Other campaigns', 'Paid search', ...,
       'Paid search', 'Organic search', 'Paid search'], dtype=object), array(['google-adsemail_outreachEmail marketingemail marketing agency pricing - https://google-adsemail_outreachEmail marketingemail marketing agency pricing',
       'clutch.coagencies-social-media-marketing-linkedinOther campaignsNo Content - https://clutch.coagencies-social-media-marketing-linkedinOther campaignsNo Content',
       'No SourceNo CampaignPaid searchNo Content - https://No SourceNo CampaignPaid searchNo Content',
       ...,
       'google-ads-_linkedinPaid searchlinkedin marketing company - https://google-ads-_linkedinPaid searchlinkedin marketing company',
       'GoogleOrganic searchwww.google.comNone - https://GoogleOrganic searchwww.google.comNone',
       'google-ads-_linkedinPaid searchlinkedin leads - https://google-ads-_linkedinPaid searchlinkedin leads'],
      dtype=object), array(['LinkedIn', 'LinkedIn', 'LinkedIn', ..., 'LinkedIn', 'LinkedIn',
       'LinkedIn'], dtype=object), array([[0.],
       [0.],
       [0.],
       ...,
       [0.],
       [0.],
       [0.]], dtype=float32)] with type list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/runner/workspace/lp_model_training.py", line 553, in <module>
    main()
  File "/home/runner/workspace/lp_model_training.py", line 524, in main
    metrics = trainer.train_cv(k=5)
              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/lp_model_training.py", line 373, in train_cv
    for fold, (train_ds, val_ds, train_idx, val_idx) in enumerate(self.data.kfold(k), 1):
  File "/home/runner/workspace/lp_model_training.py", line 168, in kfold
    self._create_dataset(train_df, train_y, shuffle=True),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/lp_model_training.py", line 207, in _create_dataset
    ds = tf.data.Dataset.from_tensor_slices((features, y))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 827, in from_tensor_slices
    return from_tensor_slices_op._from_tensor_slices(tensors, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in _from_tensor_slices
    return _TensorSliceDataset(tensors, name=name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/data/util/structure.py", line 110, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/framework/ops.py", line 736, in convert_to_tensor
    return tensor_conversion_registry.convert(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 234, in convert
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/framework/constant_tensor_conversion.py", line 29, in _constant_tensor_conversion_function
    return constant_op.constant(v, dtype=dtype, name=name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/ops/weak_tensor_ops.py", line 142, in wrapper
    return op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/framework/constant_op.py", line 276, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/framework/constant_op.py", line 289, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/framework/constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/tensorflow/python/framework/constant_op.py", line 108, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Can't convert Python sequence with mixed types to Tensor.
~/workspace$ 