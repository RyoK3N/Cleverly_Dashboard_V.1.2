Epoch 16: early stopping
Restoring model weights from the end of the best epoch: 8.
2025-07-14 23:06:49.151326: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-07-14 23:06:49,155 | INFO | Fold 1 AUC: 0.7795
2025-07-14 23:06:49,296 | INFO | Training fold 2/3 (train=1036, val=518)
Epoch 1/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 4s 147ms/step - auc: 0.4960 - loss: 0.7034 - val_auc: 0.5243 - val_loss: 0.7020 - learning_rate: 0.0010
Epoch 2/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 28ms/step - auc: 0.6651 - loss: 0.6940 - val_auc: 0.5943 - val_loss: 0.6981 - learning_rate: 0.0010
Epoch 3/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 26ms/step - auc: 0.8030 - loss: 0.6841 - val_auc: 0.6851 - val_loss: 0.6916 - learning_rate: 0.0010
Epoch 4/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 26ms/step - auc: 0.9136 - loss: 0.6681 - val_auc: 0.7498 - val_loss: 0.6803 - learning_rate: 0.0010
Epoch 5/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 36ms/step - auc: 0.9646 - loss: 0.6405 - val_auc: 0.7780 - val_loss: 0.6609 - learning_rate: 0.0010
Epoch 6/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 24ms/step - auc: 0.9790 - loss: 0.5930 - val_auc: 0.7887 - val_loss: 0.6321 - learning_rate: 0.0010
Epoch 7/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step - auc: 0.9894 - loss: 0.5020 - val_auc: 0.7910 - val_loss: 0.5948 - learning_rate: 0.0010
Epoch 8/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 29ms/step - auc: 0.9972 - loss: 0.3570 - val_auc: 0.7917 - val_loss: 0.5613 - learning_rate: 0.0010
Epoch 9/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 32ms/step - auc: 0.9995 - loss: 0.1857 - val_auc: 0.7911 - val_loss: 0.5752 - learning_rate: 0.0010
Epoch 10/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step - auc: 0.9999 - loss: 0.0697 - val_auc: 0.7857 - val_loss: 0.5823 - learning_rate: 0.0010
Epoch 11/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 23ms/step - auc: 1.0000 - loss: 0.0221 - val_auc: 0.7836 - val_loss: 0.6227 - learning_rate: 0.0010
Epoch 12/50
1/5 ━━━━━━━━━━━━━━━━━━━━ 0s 25ms/step - auc: 1.0000 - loss: 0.0133
Epoch 12: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step - auc: 1.0000 - loss: 0.0130 - val_auc: 0.7822 - val_loss: 0.6631 - learning_rate: 0.0010
Epoch 13/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step - auc: 1.0000 - loss: 0.0119 - val_auc: 0.7819 - val_loss: 0.6738 - learning_rate: 5.0000e-04
Epoch 14/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step - auc: 1.0000 - loss: 0.0115 - val_auc: 0.7818 - val_loss: 0.6823 - learning_rate: 5.0000e-04
Epoch 15/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step - auc: 1.0000 - loss: 0.0124 - val_auc: 0.7817 - val_loss: 0.6919 - learning_rate: 5.0000e-04
Epoch 16/50
1/5 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step - auc: 1.0000 - loss: 0.0119
Epoch 16: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step - auc: 1.0000 - loss: 0.0111 - val_auc: 0.7820 - val_loss: 0.6968 - learning_rate: 5.0000e-04
Epoch 16: early stopping
Restoring model weights from the end of the best epoch: 8.
2025-07-14 23:06:56.082241: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-07-14 23:06:56,086 | INFO | Fold 2 AUC: 0.7919
2025-07-14 23:06:56,220 | INFO | Training fold 3/3 (train=1036, val=518)
Epoch 1/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 4s 156ms/step - auc: 0.4942 - loss: 0.7034 - val_auc: 0.5307 - val_loss: 0.7017 - learning_rate: 0.0010
Epoch 2/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 23ms/step - auc: 0.6770 - loss: 0.6955 - val_auc: 0.5839 - val_loss: 0.6993 - learning_rate: 0.0010
Epoch 3/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step - auc: 0.8014 - loss: 0.6879 - val_auc: 0.6408 - val_loss: 0.6959 - learning_rate: 0.0010
Epoch 4/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step - auc: 0.9013 - loss: 0.6776 - val_auc: 0.6875 - val_loss: 0.6903 - learning_rate: 0.0010
Epoch 5/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step - auc: 0.9544 - loss: 0.6599 - val_auc: 0.7259 - val_loss: 0.6806 - learning_rate: 0.0010
Epoch 6/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 23ms/step - auc: 0.9790 - loss: 0.6285 - val_auc: 0.7393 - val_loss: 0.6654 - learning_rate: 0.0010
Epoch 7/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step - auc: 0.9868 - loss: 0.5647 - val_auc: 0.7536 - val_loss: 0.6388 - learning_rate: 0.0010
Epoch 8/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step - auc: 0.9976 - loss: 0.4451 - val_auc: 0.7708 - val_loss: 0.5952 - learning_rate: 0.0010
Epoch 9/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step - auc: 0.9993 - loss: 0.2681 - val_auc: 0.7748 - val_loss: 0.5763 - learning_rate: 0.0010
Epoch 10/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step - auc: 0.9999 - loss: 0.1016 - val_auc: 0.7818 - val_loss: 0.5804 - learning_rate: 0.0010
Epoch 11/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step - auc: 1.0000 - loss: 0.0278 - val_auc: 0.7872 - val_loss: 0.5927 - learning_rate: 0.0010
Epoch 12/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step - auc: 1.0000 - loss: 0.0139 - val_auc: 0.7897 - val_loss: 0.6346 - learning_rate: 0.0010
Epoch 13/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step - auc: 1.0000 - loss: 0.0106 - val_auc: 0.7901 - val_loss: 0.6795 - learning_rate: 0.0010
Epoch 14/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step - auc: 1.0000 - loss: 0.0106 - val_auc: 0.7898 - val_loss: 0.7063 - learning_rate: 0.0010
Epoch 15/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 25ms/step - auc: 1.0000 - loss: 0.0103 - val_auc: 0.7900 - val_loss: 0.7219 - learning_rate: 0.0010
Epoch 16/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step - auc: 1.0000 - loss: 0.0103 - val_auc: 0.7909 - val_loss: 0.7296 - learning_rate: 0.0010
Epoch 17/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 23ms/step - auc: 1.0000 - loss: 0.0102 - val_auc: 0.7908 - val_loss: 0.7327 - learning_rate: 0.0010
Epoch 18/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 24ms/step - auc: 1.0000 - loss: 0.0102 - val_auc: 0.7909 - val_loss: 0.7334 - learning_rate: 0.0010
Epoch 19/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step - auc: 1.0000 - loss: 0.0101 - val_auc: 0.7906 - val_loss: 0.7330 - learning_rate: 0.0010
Epoch 20/50
3/5 ━━━━━━━━━━━━━━━━━━━━ 0s 26ms/step - auc: 1.0000 - loss: 0.0101
Epoch 20: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 31ms/step - auc: 1.0000 - loss: 0.0101 - val_auc: 0.7908 - val_loss: 0.7318 - learning_rate: 0.0010
Epoch 21/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - auc: 1.0000 - loss: 0.0101 - val_auc: 0.7915 - val_loss: 0.7311 - learning_rate: 5.0000e-04
Epoch 22/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step - auc: 1.0000 - loss: 0.0100 - val_auc: 0.7913 - val_loss: 0.7303 - learning_rate: 5.0000e-04
Epoch 23/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step - auc: 1.0000 - loss: 0.0100 - val_auc: 0.7918 - val_loss: 0.7295 - learning_rate: 5.0000e-04
Epoch 24/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 23ms/step - auc: 1.0000 - loss: 0.0100 - val_auc: 0.7916 - val_loss: 0.7286 - learning_rate: 5.0000e-04
Epoch 25/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 27ms/step - auc: 1.0000 - loss: 0.0100 - val_auc: 0.7914 - val_loss: 0.7277 - learning_rate: 5.0000e-04
Epoch 26/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step - auc: 1.0000 - loss: 0.0100 - val_auc: 0.7909 - val_loss: 0.7267 - learning_rate: 5.0000e-04
Epoch 27/50
1/5 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step - auc: 1.0000 - loss: 0.0099
Epoch 27: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step - auc: 1.0000 - loss: 0.0099 - val_auc: 0.7912 - val_loss: 0.7254 - learning_rate: 5.0000e-04
Epoch 28/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step - auc: 1.0000 - loss: 0.0099 - val_auc: 0.7907 - val_loss: 0.7247 - learning_rate: 2.5000e-04
Epoch 29/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step - auc: 1.0000 - loss: 0.0099 - val_auc: 0.7906 - val_loss: 0.7241 - learning_rate: 2.5000e-04
Epoch 30/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 28ms/step - auc: 1.0000 - loss: 0.0099 - val_auc: 0.7908 - val_loss: 0.7236 - learning_rate: 2.5000e-04
Epoch 31/50
1/5 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step - auc: 1.0000 - loss: 0.0099
Epoch 31: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step - auc: 1.0000 - loss: 0.0099 - val_auc: 0.7909 - val_loss: 0.7232 - learning_rate: 2.5000e-04
Epoch 31: early stopping
Restoring model weights from the end of the best epoch: 23.
2025-07-14 23:07:04,693 | INFO | Fold 3 AUC: 0.7905
2025-07-14 23:07:04,830 | INFO | CV Results - Mean AUC: 0.7873 ± 0.0111
2025-07-14 23:07:04,831 | INFO | Training completed successfully: {'fold_aucs': [0.7794755593983393, 0.791863567925344, 0.7905368137028369], 'mean_auc': 0.7872919803421734, 'std_auc': 0.005553521193509625, 'best_fold': 2}
2025-07-14 23:07:05,009 | ERROR | Model loading failed, attempting to rebuild: `inputs` not connected to `outputs`
2025-07-14 23:07:05,009 | INFO | Rebuilding model with current architecture...
2025-07-14 23:07:05,347 | WARNING | Could not transfer weights: `inputs` not connected to `outputs`, using random initialization
2025-07-14 23:07:05,364 | ERROR | Retraining failed: Prediction failed: Data is expected to be in format `x`, `(x,)`, `(x, y)`, or `(x, y, sample_weight)`, found: (<tf.Tensor 'data:0' shape=(1,) dtype=string>, <tf.Tensor 'data_1:0' shape=(1,) dtype=string>, <tf.Tensor 'data_2:0' shape=(1,) dtype=string>, <tf.Tensor 'data_3:0' shape=(1,) dtype=string>, <tf.Tensor 'data_4:0' shape=(1,) dtype=string>, <tf.Tensor 'data_5:0' shape=(1,) dtype=string>, <tf.Tensor 'data_6:0' shape=(1,) dtype=string>, <tf.Tensor 'data_7:0' shape=(1,) dtype=string>, <tf.Tensor 'data_8:0' shape=(1,) dtype=string>, <tf.Tensor 'data_9:0' shape=(1, 1) dtype=float32>)
Traceback (most recent call last):
  File "/home/runner/workspace/lp_model_training.py", line 533, in predict_one
    prob = float(self.model.predict(ds, verbose=0)[0, 0])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/keras/src/trainers/data_adapters/data_adapter_utils.py", line 51, in unpack_x_y_sample_weight
    raise ValueError(error_msg)
ValueError: Data is expected to be in format `x`, `(x,)`, `(x, y)`, or `(x, y, sample_weight)`, found: (<tf.Tensor 'data:0' shape=(1,) dtype=string>, <tf.Tensor 'data_1:0' shape=(1,) dtype=string>, <tf.Tensor 'data_2:0' shape=(1,) dtype=string>, <tf.Tensor 'data_3:0' shape=(1,) dtype=string>, <tf.Tensor 'data_4:0' shape=(1,) dtype=string>, <tf.Tensor 'data_5:0' shape=(1,) dtype=string>, <tf.Tensor 'data_6:0' shape=(1,) dtype=string>, <tf.Tensor 'data_7:0' shape=(1,) dtype=string>, <tf.Tensor 'data_8:0' shape=(1,) dtype=string>, <tf.Tensor 'data_9:0' shape=(1, 1) dtype=float32>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/runner/workspace/retrain_model.py", line 62, in <module>
    main()
  File "/home/runner/workspace/retrain_model.py", line 54, in main
    result = predictor.predict_one(example)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/lp_model_training.py", line 539, in predict_one
    raise ModelError(f"Prediction failed: {str(e)}")
lp_model_training.ModelError: Prediction failed: Data is expected to be in format `x`, `(x,)`, `(x, y)`, or `(x, y, sample_weight)`, found: (<tf.Tensor 'data:0' shape=(1,) dtype=string>, <tf.Tensor 'data_1:0' shape=(1,) dtype=string>, <tf.Tensor 'data_2:0' shape=(1,) dtype=string>, <tf.Tensor 'data_3:0' shape=(1,) dtype=string>, <tf.Tensor 'data_4:0' shape=(1,) dtype=string>, <tf.Tensor 'data_5:0' shape=(1,) dtype=string>, <tf.Tensor 'data_6:0' shape=(1,) dtype=string>, <tf.Tensor 'data_7:0' shape=(1,) dtype=string>, <tf.Tensor 'data_8:0' shape=(1,) dtype=string>, <tf.Tensor 'data_9:0' shape=(1, 1) dtype=float32>)